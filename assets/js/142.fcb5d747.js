(window.webpackJsonp=window.webpackJsonp||[]).push([[142],{468:function(s,t,a){"use strict";a.r(t);var r=a(1),e=Object(r.a)({},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"_02-엘라스틱서치-살펴보기"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_02-엘라스틱서치-살펴보기","aria-hidden":"true"}},[s._v("#")]),s._v(" 02. 엘라스틱서치 살펴보기")]),s._v(" "),a("p",[s._v("엘라스틱 서치의 기본용어와 API 를 알아본다.")]),s._v(" "),a("h2",{attrs:{id:"_2-1-엘라스틱서치를-구성하는-개념"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-엘라스틱서치를-구성하는-개념","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.1 엘라스틱서치를 구성하는 개념")]),s._v(" "),a("p",[a("img",{attrs:{src:"/img/A112.png",alt:"엘라스틱 서치 데이터 구조"}})]),s._v(" "),a("h3",{attrs:{id:"_2-1-1-기본-용어"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-1-기본-용어","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.1.1 기본 용어")]),s._v(" "),a("h4",{attrs:{id:"인덱스"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#인덱스","aria-hidden":"true"}},[s._v("#")]),s._v(" 인덱스")]),s._v(" "),a("ul",[a("li",[s._v("데이터의 저장공간")]),s._v(" "),a("li",[s._v("하나의 인덱스는 하나의 타입만 가지며 하나의 물리적인 노드에 여려개의 논리적인 인덱스를 생성할 수 있다.")]),s._v(" "),a("li",[s._v("검색시 인덱스 이름으로 문서 데이터를 검색하며, 여러개의 인덱스를 동시에 검색하는것도 가능")])]),s._v(" "),a("h4",{attrs:{id:"샤드"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#샤드","aria-hidden":"true"}},[s._v("#")]),s._v(" 샤드")]),s._v(" "),a("ul",[a("li",[s._v("색인된 문서는 하나의 인덱스에 담기며 인덱스 내부에 색인된 데이터는 물리적 공간에 여려개의 파티션으로 나뉘어 구성되는데 이를 샤드라고 불린다.")]),s._v(" "),a("li",[s._v("엘라스틱 서치는 다수의 샤드로 문서를 분산 저장하고 있어 데이터 손실 위험을 최소화 한다.")])]),s._v(" "),a("h4",{attrs:{id:"타입"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#타입","aria-hidden":"true"}},[s._v("#")]),s._v(" 타입")]),s._v(" "),a("ul",[a("li",[s._v("인덱스의 논리적 구조를 의미")]),s._v(" "),a("li",[s._v("엘라스틱 서치 6.1 이상 버전에서는 하나의 인덱스당 하나의 타입만 설정가능")])]),s._v(" "),a("h4",{attrs:{id:"문서"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#문서","aria-hidden":"true"}},[s._v("#")]),s._v(" 문서")]),s._v(" "),a("ul",[a("li",[s._v("엘라스틱 서치에서 데이터가 저장되는 최소 단위")]),s._v(" "),a("li",[s._v("기본적으로 JSON 포맷")])]),s._v(" "),a("h4",{attrs:{id:"필드"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#필드","aria-hidden":"true"}},[s._v("#")]),s._v(" 필드")]),s._v(" "),a("ul",[a("li",[s._v("문서를 구성하기위한 속성")]),s._v(" "),a("li",[s._v("데이터베이스의 컬럼보다는 좀더 다이나믹 하며 유연하다.")])]),s._v(" "),a("h4",{attrs:{id:"매핑"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#매핑","aria-hidden":"true"}},[s._v("#")]),s._v(" 매핑")]),s._v(" "),a("ul",[a("li",[s._v("문서의 필드와 필드 속성을 정의하고 그에 따른 색인 방법을 정의하는 프로세스이다.")])]),s._v(" "),a("h3",{attrs:{id:"_2-1-2-노드의-종류"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-2-노드의-종류","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.1.2 노드의 종류")]),s._v(" "),a("h4",{attrs:{id:"마스터-노드"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#마스터-노드","aria-hidden":"true"}},[s._v("#")]),s._v(" 마스터 노드")]),s._v(" "),a("ul",[a("li",[s._v("인덱스를 생성, 삭제 하는등의 클러스터와 관련된 전반적인 작업을 담당한다.")]),s._v(" "),a("li",[s._v("네트워크 속도가 빠르고 지연이 없는 노드를 선택해야 함")])]),s._v(" "),a("h4",{attrs:{id:"데이터-노드"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#데이터-노드","aria-hidden":"true"}},[s._v("#")]),s._v(" 데이터 노드")]),s._v(" "),a("ul",[a("li",[s._v("문서가 실제로 저장되는 노드")]),s._v(" "),a("li",[s._v("색인 작업은 CPU, 메모리, 스토리지와 같은 컴퓨팅 리소스를 많이 소모하기 때문에 리소스 모니터링이 필요")])]),s._v(" "),a("h4",{attrs:{id:"코디네이팅-노드"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#코디네이팅-노드","aria-hidden":"true"}},[s._v("#")]),s._v(" 코디네이팅 노드")]),s._v(" "),a("ul",[a("li",[s._v("들어온 요청을 라운드로빈으로 분산시켜주는 도구")])]),s._v(" "),a("h4",{attrs:{id:"인제스트-노드"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#인제스트-노드","aria-hidden":"true"}},[s._v("#")]),s._v(" 인제스트 노드")]),s._v(" "),a("ul",[a("li",[s._v("색인에 앞서서 전처리하는 도구")])]),s._v(" "),a("h3",{attrs:{id:"_2-1-3-클러스터-노드-샤드"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-3-클러스터-노드-샤드","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.1.3 클러스터, 노드, 샤드")]),s._v(" "),a("p",[s._v("레플리카 샤드를 통하여 장애 극복이 가능하다.")]),s._v(" "),a("h2",{attrs:{id:"_2-2-엘라스틱서치에서-제공하는-주요-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-엘라스틱서치에서-제공하는-주요-api","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.2. 엘라스틱서치에서 제공하는 주요 API")]),s._v(" "),a("ul",[a("li",[s._v("인덱스 관리 API (Indices API)")]),s._v(" "),a("li",[s._v("문서 관리 API (Document API)")]),s._v(" "),a("li",[s._v("검색 API (Search API)")]),s._v(" "),a("li",[s._v("집계 API (Aggregation API)")])]),s._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[s._v("Index vs Indices")]),s._v(" "),a("ul",[a("li",[s._v("Index : 색인 데이터")]),s._v(" "),a("li",[s._v("Indexing : 색인을 하는 과정")]),s._v(" "),a("li",[s._v("Indices : 매핑 정보를 저장하는 논리적인 데이터 공간")])])]),s._v(" "),a("p",[a("strong",[s._v("스키마리스 (Schemaless) 기능")])]),s._v(" "),a("p",[s._v("문서를 색인하기 위해서는 기본적으로 인덱스를 색성하는 과정이 필요한데 인덱스를 생성하는 과정 없이 문서를 추가하더라도 문서가 색인되도록 지원하는 일종의 편의 기능이다.")]),s._v(" "),a("p",[s._v("하지만 이는 "),a("em",[a("strong",[s._v("성능과 밀접한 연관이 있기 때문에 특수한 상황에서만 사용")])]),s._v(" 해야 한다.")]),s._v(" "),a("h3",{attrs:{id:"_2-2-1-인덱스-관리-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1-인덱스-관리-api","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.2.1 인덱스 관리 API")]),s._v(" "),a("p",[s._v("인덱스 관리 API 는 인덱스를 관리하기 위한 API 이다. 이를 이용하여 인덱스를 추가하거나 삭제할 수 있다.")]),s._v(" "),a("p",[s._v("인덱스 관리 API는 HTTP 메서드를 지정하는 방식을 통하여 사용할 수 있다.")]),s._v(" "),a("h4",{attrs:{id:"인덱스-생성"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#인덱스-생성","aria-hidden":"true"}},[s._v("#")]),s._v(" 인덱스 생성")]),s._v(" "),a("p",[s._v("인덱스를 생성할 때는 매핑이라는 세부 설정을 이용할 수 있다.")]),s._v(" "),a("p",[s._v("매핑은 문서와 문서에 포함된 필드, 필드 타입을 세세하게 지정하는 것이 가능한 설정 방식이다.")]),s._v(" "),a("p",[s._v("한번 설정된 매핑 정보는 변경할 수 없으며 잘못 생성하거나 혹은 변경이 필요한 경우 데이터를 삭제하고 다시 색인해야 한다.")]),s._v(" "),a("h4",{attrs:{id:"인덱스-삭제"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#인덱스-삭제","aria-hidden":"true"}},[s._v("#")]),s._v(" 인덱스 삭제")]),s._v(" "),a("h3",{attrs:{id:"_2-2-2-문서-관리-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-문서-관리-api","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.2.2 문서 관리 API")]),s._v(" "),a("p",[s._v("문서 관리 API는 한건의 문서를 처리하는 "),a("code",[s._v("Single document API")]),s._v(" 와 다수의 문서를 처리하는 "),a("code",[s._v("Multi document API")]),s._v(" 로 나뉜다.")]),s._v(" "),a("h4",{attrs:{id:"single-document-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#single-document-api","aria-hidden":"true"}},[s._v("#")]),s._v(" Single Document API")]),s._v(" "),a("ul",[a("li",[s._v("Index API : 한건의 문서를 색인한다.")]),s._v(" "),a("li",[s._v("Get API : 한건의 문서를 조회한다.")]),s._v(" "),a("li",[s._v("Delete API : 한건의 문서를 삭제한다.")]),s._v(" "),a("li",[s._v("Update API : 한건의 문서를 업데이트한다.")])]),s._v(" "),a("h4",{attrs:{id:"multi-document-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#multi-document-api","aria-hidden":"true"}},[s._v("#")]),s._v(" Multi Document API")]),s._v(" "),a("ul",[a("li",[s._v("Multi Get API : 다수의 문서를 조회한다.")]),s._v(" "),a("li",[s._v("Bulk API : 대랑의 문서를 색인한다.")]),s._v(" "),a("li",[s._v("Delete By Query API : 다수의 문서를 삭제한다.")]),s._v(" "),a("li",[s._v("Update By Query API : 다수의 문서를 업데이트 한다.")]),s._v(" "),a("li",[s._v("Reindex API : 인덱스 문서를 다시 색인한다.")])]),s._v(" "),a("h4",{attrs:{id:"문서의-생성"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#문서의-생성","aria-hidden":"true"}},[s._v("#")]),s._v(" 문서의 생성")]),s._v(" "),a("p",[s._v("moive 인덱스에 문서를 추가해본다.")]),s._v(" "),a("p",[s._v("문서의 Id 는 1로 지정")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("PUT /movie/_doc/1\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"movieCd"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"movieNm"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"살아남은 아이"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"movieNmEn"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Last Child"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prdtYear"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2017"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"openDt"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"typeNm"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"장편"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prdtStatNm"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"기타"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nationAlt"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"한국"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"genreAlt"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"드라마,가족"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"repNationNm"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"한국"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"regGenreNm"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"드라마"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("생성이 완료된 문서는 하기와 같이 출력")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("br"),a("br"),a("br"),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_index"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"movie"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_type"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_doc"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_version"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" 2,\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"result"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"created"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_shards"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"total"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" 2,\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"successful"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" 1,\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"failed"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" 0\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_seq_no"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" 6,\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_primary_term"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" 2\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])])]),a("h4",{attrs:{id:"문서의-조회"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#문서의-조회","aria-hidden":"true"}},[s._v("#")]),s._v(" 문서의 조회")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("GET /movie/_doc/1\n")])])]),a("p",[s._v("실행 결과는 하기와 같다.")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_index"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"movie"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_type"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_doc"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_version"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" 2,\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_seq_no"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" 6,\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_primary_term"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" 2,\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"found"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" true,\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_source"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"movieCd"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"movieNm"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"살아남은 아이"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"movieNmEn"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Last Child"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prdtYear"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2017"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"openDt"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"typeNm"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"장편"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prdtStatNm"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"기타"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nationAlt"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"한국"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"genreAlt"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"드라마,가족"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"repNationNm"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"한국"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"regGenreNm"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"드라마"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("h4",{attrs:{id:"문서의-삭제"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#문서의-삭제","aria-hidden":"true"}},[s._v("#")]),s._v(" 문서의 삭제")]),s._v(" "),a("p",[s._v("생성된 문서의 Id 를 지어하고 DELETE 메서드를 이용하여 삭제한다.")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("DELETE /movie/_doc/1\n")])])]),a("p",[s._v("문서 삭제 결과는 하기와 같다.")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("br"),a("br"),a("br"),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_index"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"movie"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_type"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_doc"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_version"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" 3,\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"result"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"deleted"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_shards"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"total"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" 2,\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"successful"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" 1,\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"failed"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" 0\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_seq_no"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" 7,\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_primary_term"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" 2\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])])]),a("h4",{attrs:{id:"id-를-지정하지-않고-문서의-생성"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#id-를-지정하지-않고-문서의-생성","aria-hidden":"true"}},[s._v("#")]),s._v(" Id 를 지정하지 않고 문서의 생성")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("POST /movie/_doc\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"movieCd"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"movieNm"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"살아남은 아이"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"movieNmEn"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Last Child"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prdtYear"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2017"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"openDt"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2017-10-20"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"typeNm"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"장편"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prdtStatNm"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"기타"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nationAlt"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"한국"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"genreAlt"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"드라마,가족"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"repNationNm"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"한국"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"repGenreNm"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"드라마"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("moive 인덱스의 _id 값이 "),a("code",[s._v("NZEkd3ABtF6-scSgoPvm")]),s._v(" 인 데이터 1건이 성공적으로 생성되었음을 알 수 있다.")]),s._v(" "),a("p",[s._v("이때 _id 값은 UUID 를 통해 무작위로 생성된다.")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("br"),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_index"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"movie"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_type"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_doc"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"NZEkd3ABtF6-scSgoPvm"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_version"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" 1,\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"result"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"created"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_shards"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"total"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" 2,\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"successful"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" 1,\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"failed"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" 0\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_seq_no"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" 8,\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_primary_term"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" 2\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])])]),a("h3",{attrs:{id:"_2-2-3-검색-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-3-검색-api","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.2.3 검색 API")]),s._v(" "),a("p",[s._v("엘라스틱 서치 검색 API 사용법")]),s._v(" "),a("ul",[a("li",[s._v("HTTP URI 형태의 파라미터를 URI에 추가해 검색하는 방법")]),s._v(" "),a("li",[s._v("RESTful API 방식인 QueryDSL 을 사용해 본문 (Request Body) 에 질의 내용을 추가해 검색하는 방법")])]),s._v(" "),a("p",[s._v("현업에서는 Request Body 에 추가하여 사용하는 방식을 선호한다. (제약사항이 상대적으로 적기 때문)")]),s._v(" "),a("h4",{attrs:{id:"url-방식의-검색-질의"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#url-방식의-검색-질의","aria-hidden":"true"}},[s._v("#")]),s._v(" URL 방식의 검색 질의")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("GET /movie/_doc/NZEkd3ABtF6-scSgoPvm?pretty"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n")])])]),a("p",[s._v("검색 결과는 다음과 같다.")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_index"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"movie"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_type"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_doc"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"NZEkd3ABtF6-scSgoPvm"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_version"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" 1,\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_seq_no"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" 8,\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_primary_term"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" 2,\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"found"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" true,\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_source"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"movieCd"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"movieNm"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"살아남은 아이"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"movieNmEn"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Last Child"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prdtYear"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2017"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"openDt"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2017-10-20"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"typeNm"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"장편"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prdtStatNm"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"기타"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nationAlt"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"한국"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"genreAlt"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"드라마,가족"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"repNationNm"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"한국"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"repGenreNm"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"드라마"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("다음은 q 파라미터를 이용하여 해당 용어와 일치하는 문서만 조회한다.")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("POST /movie/_search?q"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("장편\n")])])]),a("p",[a("code",[s._v("typeNm")]),s._v(" 필드 값이 "),a("code",[s._v("장편")]),s._v("인 문자열만 조회")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("POST /movie/_search?q"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("typeNm:장편\n")])])]),a("h4",{attrs:{id:"request-body-방식의-검색-질의"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#request-body-방식의-검색-질의","aria-hidden":"true"}},[s._v("#")]),s._v(" Request Body 방식의 검색 질의")]),s._v(" "),a("p",[s._v("기본 구문은 아래와 같다.")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("POST /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("index 명"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/_search\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  JSON 쿼리 구문\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("moive 인덱스의 "),a("code",[s._v("typeNm")]),s._v(" 필드를 검색하는 예는 다음과 같다.")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("POST /movie/_search\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"query"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"term"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"typeNm"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"장편"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("쿼리구문은 다음과 같이 여러개의 키를 조합해 객체의 키 값으로 사용할 수 있다.")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[s._v("필드명")]),s._v(" "),a("th",{staticStyle:{"text-align":"left"}},[s._v("설명")]),s._v(" "),a("th",{staticStyle:{"text-align":"center"}},[s._v("기본값")])])]),s._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[s._v("size")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("몇 개의 결과를 반환할지 결정한다.")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("10")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[s._v("from")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("어느 위치부터 반환할지 결정한다"),a("br"),s._v("0부터 시작하면 상위 0~10건의 데이터를 반환한다.")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("0")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[s._v("_source")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("특정 필드만 결과로 반환하고 싶을 때 사용한다.")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}})]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[s._v("sort")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("특정 필드를 기준으로 정렬한다."),a("br"),a("code",[s._v("ASC")]),s._v(" "),a("code",[s._v("DESC")]),s._v(" 정렬이 가능하다.")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}})]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[s._v("query")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("검색될 조건을 정의한다.")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}})]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[s._v("filter")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("검색 결과 중 특정한 값을 다시 보여준다"),a("br"),s._v("결과 내에서 재검색 할 때 사용하는 기능중 하나다."),a("br"),s._v("다만 필터를 사용하게 되며 자동으로 score 값이 정렬되지 않는다.")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}})])])]),s._v(" "),a("h3",{attrs:{id:"_2-2-4-집계-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-4-집계-api","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.2.4 집계 API")]),s._v(" "),a("p",[s._v("과거 통계작업에는 패싯 (Facets) 기능을 많이 활용했다.")]),s._v(" "),a("p",[s._v("이는 디스크 기반으로 동작 하였고, 분산환경에 최적화되지 않았기 때문에 대용량 데이터의 통계 작업에는 적합하지 않아 많은 장애가 발생했다.")]),s._v(" "),a("p",[s._v("엘라스틱서치 5.0 이후에는 패싯 방식의 통계 기능을 과감히 제거하고 독자적인 집계 (Aggregation) API 를 내놓았다.")]),s._v(" "),a("p",[s._v("기본적으로 메모리 기반으로 동작하기 때문에 대용량의 데이터 통계 작업이 가능해졌다.")]),s._v(" "),a("h4",{attrs:{id:"데이터-집계"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#데이터-집계","aria-hidden":"true"}},[s._v("#")]),s._v(" 데이터 집계")]),s._v(" "),a("p",[s._v("moive 인덱스의 문서를 장르별로 집계해본다.")]),s._v(" "),a("p",[s._v("_search API 를 사용하여 집계 쿼리를 만들고 terms 키워드를 이용하여 generAlt 라는 필드의 데이터를 그룹화 한다.")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("POST /movie/_search?size"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"aggs"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"genre"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"terms"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"field"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"genreAlt"')]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"aggs"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nation"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"terms"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"field"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nationAlt"')]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("h4",{attrs:{id:"데이터-집계-타입"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#데이터-집계-타입","aria-hidden":"true"}},[s._v("#")]),s._v(" 데이터 집계 타입")]),s._v(" "),a("p",[s._v("집계 기능은 4가지 API 형태로 제공된다.")]),s._v(" "),a("p",[s._v("이를 조합하여 사용할 수 있다.")]),s._v(" "),a("ul",[a("li",[s._v("버킷 집계 (Bucket Aggregation)\n"),a("ul",[a("li",[s._v("집계 중 가장 많이 사용한다.")]),s._v(" "),a("li",[s._v("문서의 필드를 기준으로 버킷을 집계한다.")])])]),s._v(" "),a("li",[s._v("메트릭 집계 (Metric Aggregation)\n"),a("ul",[a("li",[s._v("문서에서 추출된 값을 가지고 Sum, Max, Min, Avg 를 계산한다.")])])]),s._v(" "),a("li",[s._v("매트릭스 집계 (Matrix Aggregation)\n"),a("ul",[a("li",[s._v("행렬의 값을 합하거나 곱한다.")])])]),s._v(" "),a("li",[s._v("파이프라인 집계 (Pipiline Aggregation)\n"),a("ul",[a("li",[s._v("버킷에서 도출된 결과 문서를 다른 필드 값으로 재분류한다.")]),s._v(" "),a("li",[s._v("다른 집계에서 생성된 출력 결과를 다시한번 집계한다.")]),s._v(" "),a("li",[s._v("집계가 패싯보다 강력한 이유가 여기에 있다.")])])])])])},[],!1,null,null,null);t.default=e.exports}}]);